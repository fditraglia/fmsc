%!TEX root = main.tex
\section{Empirical Example: Geography or Institutions?}
\label{sec:application}
\cite{Carstensen2006} address a controversial question from the development literature: does geography directly effect income after controlling for institutions? 
A number of well-known studies find little or no direct effect of geographic endowments \citep{Acemoglu,Rodrik,Easterly}. \cite{Sachs}, on the other hand, shows that malaria transmission, a variable largely driven by ecological conditions, directly influences the level of per capita income, even after controlling for institutions. Because malaria transmission is very likely endogenous, Sachs uses a measure of ``malaria ecology,'' constructed to be exogenous both to present economic conditions and public health interventions, as an instrument. 
\cite{Carstensen2006} address the robustness of Sachs's results using the following baseline regression for a sample of 44 countries:
\begin{equation}
	\mbox{ln\emph{gdpc}}_i = \beta_1 + \beta_2 \cdot \mbox{\emph{institutions}}_i + \beta_3 \cdot \mbox{\emph{malaria}}_i + \epsilon_i
\end{equation}
Treating both institutions and malaria transmission as endogenous, they consider a variety of measures of each and a number of instrument sets. 
In each case, they find large negative effects of malaria transmission, lending support to Sach's conclusion.

In this section, I revisit the instrument selection exercise given in Table 2 of \cite{Carstensen2006} using the FMSC and corrected confidence intervals described above. I consider two questions. 
First, based on the FMSC methodology, which instruments should we choose if our target parameter is $\beta_3$, the effect of malaria transmission on per capita income?
Does the selected instrument set change if our target parameter is $\beta_2$, the effect of institutions?
Second, are the results robust to the effects of instrument selection on inference?
All results are calculated by TSLS using the formulas from Section \ref{sec:chooseIVFMSC} and the variables described in Table \ref{tab:desc}, with ln\emph{gdpc} as the outcome  variable and \emph{rule} and \emph{malfal} as measures of institutions and malaria transmission.


\begin{table}[!tbp]
\small
\centering
\begin{tabular}{lll}
\hline \hline
Name& Description &\\
\hline
ln\emph{gdpc}&Real GDP/capita at PPP, 1995 International Dollars &Outcome\\
\emph{rule}&Institutional quality (Average Governance Indicator)&Regressor\\
\emph{malfal}&Fraction of population at risk of malaria transmission, 1994&Regressor\\
ln\emph{mort}&Log settler mortality (per 1000 settlers), early 19th century&Baseline\\
\emph{maleco}&Index of stability of malaria transmission&Baseline\\
\emph{frost}&Prop.\ of land receiving at least 5 days of frost in winter&Climate\\
\emph{humid}&Highest temp. in month with highest avg.\ afternoon humidity&Climate\\
\emph{latitude}&Distance from equator (absolute value of latitude in degrees)&Climate \\
\emph{eurfrac}&Fraction of pop.\ that speaks major West.\ European Language&Europe \\
\emph{engfrac}&Fraction of pop.\ that speaks English&Europe\\
\emph{coast}&Proportion of land area within 100km of sea coast&Openness\\
\emph{trade}&Log Frankel-Romer predicted trade share&Openness\\
\hline
\end{tabular}
\caption{Description of variables for Empirical Example.}
\label{tab:desc}
\end{table}

To apply the FMSC to the present example, we require a minimum of two valid instruments besides the constant term. 
Based on the arguments given by \cite{Acemoglu} and \cite{Sachs}, I proceed under the assumption that ln\emph{mort} and \emph{maleco}, measures of early settler mortality and malaria ecology, are exogenous.
Rather than selecting over all 128 possible instrument sets, I consider eight specifications formed from the four instrument blocks defined by \cite{Carstensen2006}.
The baseline block contains ln\emph{mort}, \emph{maleco} and a constant; the climate block contains \emph{frost}, \emph{humid}, and \emph{latitude}; the Europe block contains \emph{eurfrac} and \emph{engfrac}; and the openness block contains \emph{coast} and \emph{trade}. 
Full descriptions of these variables appear in Table \ref{tab:desc}.
Table \ref{tab:fullresults} lists the eight instrument sets considered here, along with TSLS estimates and traditional 95\% confidence intervals for each.\footnote{The results presented in Table \ref{tab:fullresults} are virtually identical to those of \cite{Carstensen2006}. The slight discrepancy in the results for the baseline instrument set, Panel 1, comes from the fact that \cite{Carstensen2006} include an additional observation for this specification: Vietnam. Because the Climate, Europe and Openness instrument blocks are missing for this country, I exclude it in the interest of consistency.}


\begin{table}[h]
\centering
\input{../EmpiricalExample/Results/table_2SLS.tex}
\caption{Two-stage least squares estimation results for all instrument sets.}
\label{tab:fullresults}

\end{table}

Table \ref{tab:FMSC_values} presents FMSC and positive-part FMSC results for instrument sets 1--8  as defined in Table \ref{tab:fullresults}.
The positive-part FMSC sets a negative squared asymptotic bias estimate to zero when estimating AMSE.
When the squared bias estimate is positive, FMSC and positive-part FMSC coincide; when the squared bias estimate is negative, positive-part FMSC is strictly greater than FMSC. 
Additional simulation results for the choosing instrumental variables experiment from Section \ref{sec:chooseIVsim}, available upon request, reveal that the positive-part FMSC never performs worse than the ordinary FMSC and sometimes performs better, suggesting that it should be preferred in real-world applications. 
For each criterion Table \ref{tab:FMSC_values} presents two cases: the first takes the effect of \emph{malfal}, a measure of malaria transmission, as the target parameter while the second uses the effect of \emph{rule}, a measure of institutions. 
In each case the two best instrument sets are numbers 5 (baseline, climate and Europe) and 8 (all instruments).\footnote{In Table 2 of their paper, \cite{Carstensen2006} report results for selection over instrument sets 2--4 and 8 using the GMM-BIC and HQ of \cite{Andrews1999}. Both favor instrument set 8. They do not consider instrument sets 5--7.}
When the target parameter is the coefficient on \emph{malfal}, 8 is the clear winner under both the plain-vanilla and positive-part FMSC, leading to an estimate of $-1.08$ for the effect of malaria transmission on per-capita income.
When the target parameter is the coefficient on \emph{rule}, however, instrument sets 5 and 8 are virtually indistinguishable.
Indeed, while the plain-vanilla FMSC selects instrument set 8, leading to an estimate of $0.84$ for the effect of instutitions on per-capita income, the positive-part FMSC selects instrument set 5, leading to an estimate of $0.93$. 
Thus the FMSC methodology shows that, while helpful for estimating the effect of malaria transmission, the openness instruments \emph{coast} and \emph{trade} provide essentially no additional information for studying the effect of institutions.

\begin{table}[htbp]
	\centering
	\input{../EmpiricalExample/Results/table_fmsc_values.tex}
		\caption{FMSC and and positive-part FMSC values corresponding to the instrument sets from Table \ref{tab:fullresults}}
		\label{tab:FMSC_values}
\end{table}

Table \ref{tab:postFMSC_CIs} presents three alternative post-selection confidence intervals for each of the instrument selection exercises from Table \ref{tab:FMSC_values}: Na\"{i}ve, 1-Step, and 2-Step.
The Na\"{i}ve intervals are standard, nominal 95\% confidence intervals that ignore the effects of instrument selection.
These are constructed by identifying the selected instrument set from Table \ref{tab:FMSC_values} and simply reporting the corresponding nominal 95\% interval from Table \ref{tab:fullresults} unaltered.
The 1-Step intervals are simulation-based nominal 95\% intervals constructed using a simplified, and less computationally intensive, version of the procedure given in Algorithm \ref{alg:conf}.
Rather than taking the minimum lower confidence limit and maximum upper confidence limit over all values in a given confidence region for $\tau$, this procedure simply assumes that the estimated value $\widehat{\tau}$ is exactly correct, and generates simulations for $\Lambda$ under this assumption.
Neither the Na\"{i}ve nor the 1-Step procedures yield valid 95\% confidence intervals.
They are provided merely for comparison with the 2-Step procedure, which fully implements Algorithm \ref{alg:conf} with $\alpha = \delta = 0.05$ and $J=10,000$. 
As explained above, the 2-Step interval is guaranteed to have asymptotic coverage probability of at least $1 - \alpha - \delta$, in this case 90\%.
From the 2-Step intervals, we see that the results of \cite{Carstensen2006} are extremely robust. 
There is no evidence that accounting for the effects of instrument selection changes our conclusions about the sign or significance of \emph{malfal} or \emph{rule}.

\begin{table}[htbp]
	\centering
	\input{../EmpiricalExample/Results/table_CIs.tex}
	\caption{Post-selection CIs for the instrument selection exercise from Table \ref{tab:FMSC_values}.}
	\label{tab:postFMSC_CIs}
\end{table}

Given the simplicity of the second-stage regression and the relatively small sample size, one might reasonably wonder whether this empirical example represents a realistic proof of concept for FMSC instrument selection and post-selection inference.
The answer is yes: this example was selected precisely because it is as simple as possible in those respects that matter least for the FMSC and confidence interval calculations yet fully realistic in those respects that matter most.
The computational complexity of the procedures described above is determined almost entirely by the dimension, $q$, of $\tau$, in this case the number of suspect instruments in the full instrument set.
This is because the 2-Step confidence interval procedure requires us to carry out two $q$-dimensional constrained optimization problems with a stochastic objective function: one for the lower confidence limit and another for the upper confidence limit.
Next most important is $J$, the number of simulation draws used, as this quantity determines the computational cost of a single evaluation of the objective function.
In contrast, the number of instrument sets under consideration is considerably less important because we can pre-compute all associated quantities: they do not vary with $\tau^*$.
Least important of all are the number of first-stage regressors and the sample size. For all practical purposes these are irrelevant.
To put this another way, carrying out FMSC or positive-part FMSC selection is trivial; constructing valid confidence intervals, however, is challenging. 
With seven suspect instruments, $10000$ simulation draws, and eight instrument sets under consideration, this example presents the kind of computational challenge that one would reasonably expect to encounter in practice.
Using a more complicated second-stage, more observations, or even double as many instrument sets would make practically no difference.
In spite of the difficulties involved, problems of this magnitude are well within the ability of a standard desktop computer using off-the-shelf optimization routines. 
Running on a single core, it took just under eleven minutes to generate all of the empirical results in this paper. 
Note that this involves constructing \emph{four} 2-Step confidence intervals.
For more computational details, including a description of the packages used, see Appendix \ref{append:comp}. 
 

