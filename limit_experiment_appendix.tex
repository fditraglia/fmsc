%!TEX root = main.tex
\section{A Special Case of Post-FMSC Inference}
This appendix presents calculations and numerical results to supplement Section \ref{sec:limitexperiment}.

\subsection{The Limit Experiment}
\label{append:limitexperiment}
The joint limit distribution for the OLS versus TSLS example from Section \ref{sec:OLSvsIVExample} is as follows
\begin{equation*}
  \left[ 
  \begin{array}{c}
    \sqrt{n} \left( \widehat{\beta}_{OLS} - \beta \right)\\
    \sqrt{n} \left( \widetilde{\beta}_{TSLS} - \beta \right)\\
    \widehat{\tau}
\end{array}
\right] \overset{d}{\rightarrow} N\left( \left[
\begin{array}{c}
  \tau/\sigma_x^2 \\ 0 \\ \tau
\end{array}
\right], \sigma_{\epsilon}^2 
\left[
\begin{array}{ccc}
  1/\sigma_x^2 & 1/\sigma_x^2 & 0\\
  1/\sigma_x^2 & 1/\gamma^2 & -\sigma_v^2/\gamma^2\\
  0 & -\sigma_v^2/\gamma^2 & \sigma_x^2 \sigma_v^2/\gamma^2
\end{array}
\right]\right).
\end{equation*}
Now consider a slightly simplified version of the choosing instrumental variables example from Section \ref{sec:chooseIVexample}, namely
\begin{eqnarray*}
  y_{ni} &=& \beta x_{ni} + \epsilon_{ni}\\
  x_{ni} &=& \gamma w_{ni} + \mathbf{z}_{ni}' \boldsymbol{\pi} + v_{ni}
\end{eqnarray*}
where $x$ is the endogenous regressor of interest, $\mathbf{z}$ is a vector of exogenous instruments, and $w$ is a single potentially endogenous instrument.
Without loss of generality assume that $w$ and $\mathbf{z}$ are uncorrelated and that all random variables are mean zero.
For simplicity, further assume that the errors satisfy the same kind of asymptotic homoskedasticity condition used in the OLS versus TSLS example so that TSLS is the efficient GMM estimator.
Let the ``Full'' estimator denote the TSLS estimator using $w$ and $\mathbf{z}$ and the ``Valid'' estimator denote the TSLS estimator using only $\mathbf{z}$.
Then we have,
\begin{equation*}
  \left[ 
  \begin{array}{c}
    \sqrt{n} \left( \widehat{\beta}_{Full} - \beta \right)\\
    \sqrt{n} \left( \widetilde{\beta}_{Valid} - \beta \right)\\
    \widehat{\tau}
\end{array}
\right] \overset{d}{\rightarrow} N\left( \left[
\begin{array}{c}
  \tau\gamma/q^2_{F} \\ 0 \\ \tau
\end{array}
\right], \sigma_{\epsilon}^2 
\left[
\begin{array}{ccc}
  1/q_{F}^2 & 1/q_{F}^2 & 0\\
  1/q_{F}^2 & 1/q_{V}^2 & -\gamma\sigma_w^2/q^2_{V}\\ 
  0 & -\gamma\sigma_w^2/q^2_{V} & \sigma_w^2 q^2_{F}/q^2_{V}
\end{array}
\right]\right)
\end{equation*}
where $q^2_{F} = \gamma^2 \sigma_w^2 + q^2_{V}$, $q^2_{V} = \boldsymbol{\pi}'\Sigma_{zz}\boldsymbol{\pi}$, $\Sigma_{zz}$ is the covariance matrix of the valid instruments $\mathbf{z}$, and $\sigma_w^2$ is the variance of the ``suspect'' instrument $w$.
After some algebraic manipulations we see that both of these examples share the same structure, namely
\begin{equation}
  \label{eq:limitExperiment}
  \left[ 
  \begin{array}{c}
    \sqrt{n} \left( \widehat{\beta} - \beta \right)\\
    \sqrt{n} \left( \widetilde{\beta} - \beta \right)\\
    \widehat{\tau}
\end{array}
\right] \overset{d}{\rightarrow} 
\left[
\begin{array}{c}
  U \\ V \\ T
\end{array}
\right] \sim
N\left( \left[
\begin{array}{c}
  c\tau\\ 0 \\ \tau
\end{array}
\right], 
\left[
\begin{array}{ccc}
  \eta^2 & \eta^2 & 0\\
  \eta^2 & \eta^2 + c^2 \sigma^2 & -c\sigma^2\\ 
  0 & -c\sigma^2 & \sigma^2 
\end{array}
\right]\right)
\end{equation}
where $\widehat{\beta}$ denotes the low variance but possibly biased estimator, and $\widetilde{\beta}$ denotes the higher variance but unbiased estimator.
For any example with a limit distribution that takes this form, simple algebra shows that FMSC selection amounts to choosing $\widehat{\beta}$ whenever $|\widehat{\tau}|<\sqrt{2}\sigma$, and choosing $\widetilde{\beta}$ otherwise, in other words
\begin{eqnarray*}
  \sqrt{n}(\widehat{\beta}_{FMSC} - \beta) = \mathbf{1}\left\{ |\widehat{\tau}|<\sigma \sqrt{2} \right\} \sqrt{n}(\widehat{\beta} - \beta) +  \mathbf{1}\left\{ |\widehat{\tau}|\geq\sigma \sqrt{2} \right\}\sqrt{n}(\widetilde{\beta} - \beta)
\end{eqnarray*}
and so by the Continuous Mapping Theorem,
\begin{equation*}
  \sqrt{n}(\widehat{\beta}_{FMSC} - \beta) \overset{d}{\rightarrow}  \mathbf{1}\left\{ |T|<\sigma \sqrt{2} \right\} U +  \mathbf{1}\left\{ |T|\geq\sigma \sqrt{2} \right\} V.
\end{equation*}
Re-expressing Equation \ref{eq:limitExperiment} in terms of the marginal distribution of $T$ and the conditional distribution of $U$ and $V$ given $T$, we find that $T \sim N(\tau, \sigma^2)$ and 
\begin{equation*}
  \left.\left[
  \begin{array}{c}
   U \\ V 
  \end{array}
\right]\right| (T = t) \sim N\left(
\left[
\begin{array}{c}
  c \tau \\ c\tau - ct
\end{array}
\right], \eta^2
\left[
\begin{array}{cc}
  1 & 1 \\ 1 & 1
\end{array}
\right]
\right)
\end{equation*}
which is a \emph{singular distribution}.
While $U$ is independent of $T$, but conditional on $T$ the random variables $U$ and $V$ are perfectly correlated with the same variance.
Given $T$, the only difference between $U$ and $V$ is that the mean of $V$ is shifted by a distance that depends on the realization $t$ of $T$.
Thus, the conditional distribution of $V$ shows a \emph{random bias}: on average $V$ has mean zero because the mean of $T$ is $\tau$ but any particular realization $t$ of $T$ will not in general equal $\tau$.
Using the form of the conditional distributions we can express the distribution of $(U,V,T)'$ in a more transparent form as
\begin{eqnarray*}
  T &=& \sigma Z_1 + \tau\\
  U &=& \eta Z_2 + c\tau\\
  V &=& \eta Z_2 - c\sigma Z_1
\end{eqnarray*}
where $Z_1, Z_2$ are independent standard normal random variables.

\subsection{Numerical Results for the 2-Step Interval}
\label{append:limitexperiment_2step}
For the two-step procedure I take lower and upper bounds over a collection of equal-tailed intervals. 
It does not necessarily follow that the bounds over these intervals would be tighter if each interval in the collection were constructed to be a short as possible.
As we are free when using the 2-Step interval to choose any pair $(\alpha_1, \alpha_2)$ such that $\alpha_1 + \alpha_2 = \alpha$ I experimented with three possibilities: $\alpha_1 = \alpha_2 = \alpha/2$, followed by $\alpha_1 = \alpha/4, \alpha_2 = 3\alpha/4$ and $\alpha_1 = 3\alpha/4, \alpha_2 = \alpha/4$.
Setting $\alpha_1 = \alpha/4$ produced the shortest intervals so I discuss only results for the middle configuration here.
Additional results are available on request.
As we see from Table \ref{tab:Limit2StepWideTauOLSvsIV} for the OLS versus TSLS example and Table \ref{tab:Limit2StepWideTauChooseIVs} for the choosing IVs example, this procedure delivers on its promise that asymptotic coverage will never fall below $1-\alpha$ but this comes at the cost of extreme conservatism and correspondingly wider intervals.



\begin{table}[h]
  \centering
  \begin{subtable}{0.48\textwidth}
    \caption{Coverage Probability}
    \input{./AdditionalSimulations/LimitSimResults/c_2widetau_OLSvsIV.tex}
  \end{subtable}
  ~
  \begin{subtable}{0.48\textwidth}
    \caption{Relative Width}
    \input{./AdditionalSimulations/LimitSimResults/w_2widetau_OLSvsIV.tex}
  \end{subtable}
  \caption{OLS versus TSLS Example: Asymptotic coverage and expected relative width of two-step confidence interval with $\alpha_1 = \alpha/4,  \alpha_2 = 3\alpha/4$.}
  \label{tab:Limit2StepWideTauOLSvsIV}
\end{table}

\begin{table}[h]
  \centering
  \begin{subtable}{0.48\textwidth}
    \caption{Coverage Probability}
    \input{./AdditionalSimulations/LimitSimResults/c_2widetau_chooseIVs.tex}
  \end{subtable}
  ~
  \begin{subtable}{0.48\textwidth}
    \caption{Relative Width}
    \input{./AdditionalSimulations/LimitSimResults/w_2widetau_chooseIVs.tex}
  \end{subtable}
  \caption{Choosing IVs Example: Asymptotic coverage and expected relative width of two-step confidence interval with $\alpha_1 = \alpha/4,  \alpha_2 = 3\alpha/4$.}
  \label{tab:Limit2StepWideTauChooseIVs}
\end{table}
